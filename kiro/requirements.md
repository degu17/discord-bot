# 要件書

## はじめに

Discord botの自動モデレーション機能は、コミュニティの健全性を維持するために不適切なメッセージを自動的に検出し、適切な対応を行う機能です。この機能により、管理者の負担を軽減し、24時間体制でのコミュニティ管理を実現します。

## 要件

### 要件1

**ユーザーストーリー:** コミュニティ管理者として、不適切な言葉を含むメッセージを自動的に検出して警告を発行したい。これにより、軽度な問題を早期に対処できる。

#### 受け入れ基準

1. WHEN ユーザーがレベル1の不適切語（「ばか」等の軽度な言葉）を含むメッセージを送信した THEN システムは警告メッセージを自動的に表示する
2. WHEN 警告が発行された THEN システムは元のメッセージを削除せずに残す
3. WHEN 警告メッセージが表示された THEN システムはログに記録する

### 要件2

**ユーザーストーリー:** コミュニティ管理者として、中程度の不適切なメッセージを自動的に削除したい。これにより、コミュニティの品質を維持できる。

#### 受け入れ基準

1. WHEN ユーザーがレベル2の不適切語を含むメッセージを送信した THEN システムはメッセージを自動的に削除する
2. WHEN メッセージが削除された THEN システムは削除通知メッセージを表示する
3. WHEN メッセージが削除された THEN システムは削除ログを記録する
4. IF メッセージ削除に失敗した THEN システムは管理者に通知する

### 要件3

**ユーザーストーリー:** コミュニティ管理者として、重度の不適切なメッセージを送信したユーザーを一時的に制限したい。これにより、深刻な問題を即座に対処できる。

#### 受け入れ基準

1. WHEN ユーザーがレベル3の不適切語を含むメッセージを送信した THEN システムは該当ユーザーを10分間タイムアウトする
2. WHEN ユーザーがタイムアウトされた THEN システムはメッセージを削除し、制限通知を表示する
3. WHEN タイムアウトが実行された THEN システムは制限ログを記録する
4. IF タイムアウト実行に失敗した THEN システムは管理者に通知する

### 要件4

**ユーザーストーリー:** コミュニティ管理者として、検出ワードを設定ファイルで管理したい。これにより、コミュニティの特性に応じて柔軟に調整できる。

#### 受け入れ基準

1. WHEN 管理者が設定ファイルを更新した THEN システムは新しい検出ワードを適用する
2. WHEN システムが起動した THEN システムは設定ファイルから検出ワードを読み込む
3. IF 設定ファイルが存在しない THEN システムはデフォルトの検出ワードを使用する
4. WHEN 設定ファイルの形式が不正な場合 THEN システムはエラーログを出力し、デフォルト設定を使用する

### 要件5

**ユーザーストーリー:** コミュニティ管理者として、モデレーション活動のログを確認したい。これにより、コミュニティの状況を把握し、必要に応じて対策を講じることができる。

#### 受け入れ基準

1. WHEN モデレーション機能が実行された THEN システムは日時、ユーザー、メッセージ内容、実行されたアクションをログに記録する
2. WHEN ログが記録された THEN システムはログファイルに永続化する
3. WHEN ログファイルが一定サイズを超えた THEN システムは古いログをローテーションする
4. IF ログ記録に失敗した THEN システムはコンソールにエラーを出力する

